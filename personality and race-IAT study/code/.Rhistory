Variable == "data_demographics" ~ "one-row-one-participant and age is numerical",
Variable == "data_iat" ~ "",
Variable == "data_bfi" ~ "",
Variable == "data_bfi_completeness" ~ "",
Variable == "ddata_iat_completeness" ~ "",
Variable == "data_bfi_logical_scores" ~ "",
Variable == "data_bfi_meanscore" ~ "",
Variable == "data_bfi_rev" ~ "",
Variable == "data_bfi_rev_without_onrc" ~ "",
Variable == "data_bfi_rev_without_onrc_ex_compl" ~ "",
Variable == "data_demographics_raw" ~ "",
Variable == "data_iat_D" ~ "",
Variable == "data_iat_mean1" ~ "",
Variable == "data_iat_mean2" ~ "",
Variable == "data_iat_performance" ~ "",
Variable == "data_iat_SD" ~ "",
Variable == "data_processed" ~ "",
Variable == "data_processed_temp" ~ "",
Variable == "maxscore_bfi_e" ~ "",
Variable == "maxscore_bfi_c" ~ "",
Variable == "maxscore_bfi_n" ~ "",
Variable == "maxscore_bfi_a" ~ "",
Variable == "maxscore_bfi_o" ~ "",
Variable == "minscore_bfi_e" ~ "",
Variable == "minscore_bfi_c" ~ "",
Variable == "minscore_bfi_n" ~ "",
Variable == "minscore_bfi_a" ~ "",
Variable == "minscore_bfi_o" ~ "",
Variable == "cor_bfi_e" ~ "",
Variable == "cor_bfi_c" ~ "",
Variable == "cor_bfi_n" ~ "",
Variable == "cor_bfi_a" ~ "",
Variable == "cor_bfi_o" ~ "",
Variable == "negative_values_e_exist" ~ "",
Variable == "negative_values_c_exist" ~ "",
Variable == "negative_values_n_exist" ~ "",
Variable == "negative_values_a_exist" ~ "",
Variable == "negative_values_o_exist" ~ "",
Variable == "result_range_e" ~ "",
Variable == "result_range_c" ~ "",
Variable == "result_range_n" ~ "",
Variable == "result_range_a" ~ "",
Variable == "result_range_o" ~ "",
Variable == "result_bfi_compl" ~ "",
Variable == "result_bfi_logical_scores" ~ "",
Variable == "result_iat_compl" ~ "",
Variable == "result_iat_perf" ~ "",
Variable == "result_master_exclusion" ~ "",
Variable == "codebook_E" ~ "",
Variable == "codebook_R" ~ "",
Variable == "sorted_variable_codebook_E_dp_vtr" ~ "",
Variable == "variable_codebook_E" ~ "",
Variable == "variable_codebook_E_dp" ~ "",
Variable == "variable_codebook_E_dp_vtr" ~ "",
Variable == "variable_to_add_E" ~ "",
Variable == "variable_to_add_R" ~ "",
Variable == "variables_to_remove_R" ~ "",
Variable == "variable_codebook_R_ls" ~ "",
Variable == "bfi_e_mean" ~ "",
Variable == "bfi_c_mean" ~ "",
Variable == "bfi_n_mean" ~ "",
Variable == "bfi_a_mean" ~ "",
Variable == "bfi_o_mean" ~ "",
Variable == "exclude_bfi_completeness" ~ "",
Variable == "exclude_bfi_logical_scores" ~ "",
Variable == "exclude_iat_completeness" ~ "",
Variable == "exclude_iat_performance" ~ "",
Variable == "exclude_participant" ~ "",
Variable == "iat_D" ~ "",
Variable == "iat_SD" ~ "",
Variable == "iat_mean1" ~ "",
Variable == "iat_mean2" ~ "",
Variable == "unique_id" ~   "",
Variable == "age" ~   "",
Variable == "gender" ~   "",
Variable == "bfi_e1_rev,...,bfi_e9_rev" ~   "",
Variable == "bfi_c1_rev,...,bfi_c9_rev" ~   "",
Variable == "bfi_n1_rev,...,bfi_n9_rev" ~   "",
Variable == "bfi_a1_rev,...,bfi_a9_rev" ~   "",
Variable == "bfi_o1_rev,...,bfi_o9_rev" ~   "",
Variable == "bfi_e1,...,bfi_e9" ~   "",
Variable == "bfi_c1,...,bfi_c9" ~   "",
Variable == "bfi_n1,...,bfi_n9" ~   "",
Variable == "bfi_a1,...,bfi_a9" ~   "",
Variable == "bfi_o1,...,bfi_o9" ~   "",
TRUE ~ NA))
# Create an Excel workbook
wb_Codebook_R <- createWorkbook()
# Add a worksheet named "Codebook" to the workbook
addWorksheet(wb_Codebook_R, "Codebook")
# Write the data frame 'codebook_R' to the "Codebook" worksheet
writeData(wb_Codebook_R, "Codebook", codebook_R)
# Adjust the column widths of the "Codebook" worksheet to fit the content
setColWidths(wb_Codebook_R, "Codebook", cols = 1:ncol(codebook_R), widths = "auto")
# Get the current working directory
script_dir <- getwd()
# Save the workbook to an Excel file in the same directory as the R script
saveWorkbook(wb_Codebook_R, file = file.path(script_dir, "R_processing_codebook.xlsx"), overwrite = TRUE)
sessionInfo()
maxscore_bfi_e
# set knit options
knitr::opts_chunk$set(message = FALSE,
warning = FALSE)
# disable scientific notation
options(scipen = 999)
library(patchwork)
library(tidyverse)
library(knitr)
library(kableExtra)
library(ggplot2)
library(janitor)
library(scales)
library(cowplot)
library(ggExtra)
library(psych)
library(plyr)
library(dplyr)
library(stringr)
library(report)
#Load the processed data
data_processed <- read_csv("../data/processed/data_processed.csv")
#Exclude rows without unique_id --> exclude_unique_id_is.na
data_processed_without_unique_id <- data_processed |>
filter(exclude_unique_id_is.na == "include")
#Exclude rows where participants have not participated in BFI and IAT
data_processed_BFI_IAT_answers <- data_processed %>%
filter(!is.na(exclude_bfi_completeness) & !is.na(exclude_iat_completeness))
#Exclude participants --> master exclusion variable
data_processed_after_exclusions <- data_processed |>
filter(exclude_participant == "include")
cat("The question is 'what do you mean by total number of participants before exclusions'?\n Before any exclusion, there is the count of rows, which you can see in the next table (1968).")
data_processed  %>%
{data.frame(n = nrow(.))} %>%
kable() %>%
add_header_above(header = c("Whole sample" = 1)) %>%
kable_classic(full_width = FALSE)
cat("However, there are also rows where no unique_id exists. Do these empty rows also represent participants, or should they be ignored? If ignored, the count would be 1932.")
data_processed_without_unique_id %>%
{data.frame(n = nrow(.))} %>%
kable() %>%
add_header_above(header = c("Whole sample with unique_id" = 1)) %>%
kable_classic(full_width = FALSE)
cat("And assuming that the demographic questions were only an option and the actual study revolves around IAT and BFI, could one argue that we only consider individuals who have answered at least one item in BFI and/or IAT? In that case, the count would be 179.")
data_processed_BFI_IAT_answers %>%
{data.frame(n = nrow(.))} %>%
kable() %>%
add_header_above(header = c("Whole sample with IAT and BFI answers" = 1)) %>%
kable_classic(full_width = FALSE)
data_processed_after_exclusions %>%
{data.frame(n = nrow(.))} %>%
kable() %>%
add_header_above(header = c("For analysis" = 1)) %>%
kable_classic(full_width = FALSE)
data_processed_after_exclusions |>
mutate(age = as.numeric(age)) |>
summarise(Mean = mean(age, na.rm = TRUE),
SD = sd(age, na.rm = TRUE)) |>
mutate_all(.funs = janitor::round_half_up, digits = 1) |>
kable() |>
add_header_above(header = c("Age" = 2)) |>
kable_classic(full_width = FALSE)
#Information about age = NA
count_na_age_number <- sum(is.na(data_processed_after_exclusions$age))
count_na_age_proprtion<-round((nrow(data_processed_after_exclusions)-sum(is.na(data_processed_after_exclusions$age)))/nrow(data_processed_after_exclusions),2)
cat(count_na_age_number, "person(s) reported no age.\n The proportion of participants for which the age variable was available is",count_na_age_proprtion,".")
gender<-data_processed_after_exclusions$gender|>
count()
colnames(gender)[colnames(gender) == "x"] <- "Gender"
colnames(gender)[colnames(gender) == "freq"] <- "n"
gender<-gender|>mutate(Gender = case_when(Gender == "f" ~ "Female",
Gender == "m" ~ "Male"),
percent = paste0(round_half_up((n / sum(n)) * 100, 1), "%"))
table_gender <- gender |>
kable() |>
kable_classic(full_width = FALSE)
table_gender
#data_processed_after_exclusions|>
#  rename(Gender=gender)|>
#  group_by(Gender)|>
#  summarise(n=n())|>
#  mutate(Percent=paste()(round_half_up((n/sum(n))*100,1),"%"))|>
#  mutate(Gender=stringr::str_to_sentence(Gender))|>
#  kable()|>
#  kable_classic(full_width=FALSE)
#Information about gender = NA
count_na_gender_number <- sum(is.na(data_processed_after_exclusions$gender))
count_na_gender_proprtion<-round((nrow(data_processed_after_exclusions)-sum(is.na(data_processed_after_exclusions$gender)))/nrow(data_processed_after_exclusions),2)
cat(count_na_gender_number, "person(s) reported no age.\n The proportion of participants for which the age variable was available is",count_na_gender_proprtion,".")
data_alpha_e <- data_processed_after_exclusions |>
select(starts_with("bfi_e")) |>
select(-bfi_e_mean)
data_alpha_c <- data_processed_after_exclusions |>
select(starts_with("bfi_c")) |>
select(-bfi_c_mean)
data_alpha_n <- data_processed_after_exclusions |>
select(starts_with("bfi_n")) |>
select(-bfi_n_mean)
data_alpha_a <- data_processed_after_exclusions |>
select(starts_with("bfi_a")) |>
select(-bfi_a_mean)
data_alpha_o <- data_processed_after_exclusions |>
select(starts_with("bfi_o")) |>
select(-bfi_o_mean)
alpha_e <- alpha( data_alpha_e, na.rm = TRUE)
alpha_c <- alpha( data_alpha_c, na.rm = TRUE)
alpha_n <- alpha( data_alpha_n, na.rm = TRUE)
alpha_a <- alpha( data_alpha_a, na.rm = TRUE)
alpha_o <- alpha( data_alpha_o, na.rm = TRUE)
cat("Cronbach's alpha for the subscales:\n
extroversion:", round(alpha_e$total$raw_alpha,2), "\n
conscientiousness:",round( alpha_c$total$raw_alpha,2), "\n
neuroticism:", round(alpha_n$total$raw_alpha,2), "\n
agreeableness:", round(alpha_a$total$raw_alpha,2), "\n
openness:", round(alpha_o$total$raw_alpha,2), "\n")
#extroversion
ggplot(data_processed_after_exclusions, aes(x = bfi_e_mean))+
geom_histogram(binwidth = 0.1,
fill = "steelblue",
color = "black") +
labs(title="Distribution of extroversion ",x="Mean extraversion",y="Frequency")+
theme_linedraw() +
scale_x_continuous(breaks = pretty_breaks(n = 10))
#conscientiousness
ggplot(data_processed_after_exclusions, aes(x = bfi_c_mean)) +
geom_histogram(binwidth = 0.1,
fill = "steelblue",
color = "black") +
labs(title="Distribution of conscientiousness ",x="Mean conscientiousness",y="Frequency")+
theme_linedraw() +
scale_x_continuous(breaks = pretty_breaks(n = 10)) +
scale_y_continuous(breaks = seq(0, 10, by = 2),
labels = as.character(seq(0, 10, by = 2)))
#neuroticism
ggplot(data_processed_after_exclusions, aes(x = bfi_n_mean)) +
geom_histogram(binwidth = 0.1,
fill = "steelblue",
color = "black") +
labs(title="Distribution of neuroticism",x="Mean neuroticism",y="Frequency")+
theme_linedraw() +
scale_x_continuous(breaks = pretty_breaks(n = 10))
#agreeableness
ggplot(data_processed_after_exclusions, aes(x = bfi_a_mean)) +
geom_histogram(binwidth = 0.1,
fill = "steelblue",
color = "black") +
labs(title="Distribution of agreeableness",x="Mean agreeableness",y="Frequency")+
theme_linedraw() +
scale_x_continuous(breaks = pretty_breaks(n = 10))+
scale_y_continuous(breaks = seq(0, 10, by = 2),
labels = as.character(seq(0, 10, by = 2)))
#openness
ggplot(data_processed_after_exclusions, aes(x = bfi_o_mean)) +
geom_histogram(binwidth = 0.1,
fill = "steelblue",
color = "black") +
labs(title="Distribution of openness",x="Mean openness",y="Frequency")+
theme_linedraw() +
scale_x_continuous(breaks = pretty_breaks(n = 10))
#IAT
ggplot(data_processed_after_exclusions, aes(x = iat_D)) +
geom_histogram(binwidth = 0.03,
boundary = 0,
fill = "steelblue",
color = "black") +
labs(title="Distribution of IAT scores",x="IAT",y="Frequency")+
theme_linedraw() +
scale_x_continuous(breaks = pretty_breaks(n = 10))
# List of BFI subscales and IAT for correlations
variables <- c("bfi_e_mean", "bfi_c_mean", "bfi_n_mean", "bfi_a_mean", "bfi_o_mean", "iat_D")
# Calculate the correlation matrix for each pair of variables
cor_matrix <- matrix(NA, nrow = length(variables), ncol = length(variables))
for (i in 1:length(variables)) {
for (j in 1:length(variables)) {
# Select only the rows without NA values for both variables
non_na_rows <- complete.cases(data_processed_after_exclusions[, c(variables[i], variables[j])])
# Calculate the correlation and store it in the matrix
cor_matrix[i, j] <- cor(data_processed_after_exclusions[non_na_rows, variables[i]],
data_processed_after_exclusions[non_na_rows, variables[j]],
method = "pearson")
}
}
# Round the values to two decimal places
cor_matrix_rounded <- round(cor_matrix, 2)
# Convert the matrix to a data frame
cor_matrix_df <- as.data.frame(cor_matrix_rounded)
# Add row and column names
row.names(cor_matrix_df) <- colnames(cor_matrix_df) <- variables
{cor_matrix_df}
# Assuming 'iat_scores' is the variable containing IAT scores
shapiro_test <- shapiro.test(data_processed_after_exclusions$iat_D)
# Print the results
# Check the p-value against the chosen significance level (e.g., 0.05)
if (shapiro_test$p.value < 0.05) {
cat("The data is not normally distributed based on the Shapiro-Wilk test (p-value=", round(shapiro_test$p.value,2),").")
} else {
cat("The data appears to be normally distributed based on the Shapiro-Wilk test (p-value=", round(shapiro_test$p.value,2),").")
}
t_test_result <- t.test(iat_D ~ gender, data = data_processed_after_exclusions)
if (t_test_result$p.value < 0.05) {
cat("Men and women differ on their scores on the IAT (p-value:", round(t_test_result$p.value,2),").")
} else {
cat("Men and women don't differ on their scores on the IAT (p-value:", round(t_test_result$p.value,2),").")
}
cat("t-Test Results:\n Test Statistic:", t_test_result$statistic, "\n Degrees of Freedom:", t_test_result$parameter, "\n Mean Difference:", mean(data_processed_after_exclusions$iat_scores[data_processed_after_exclusions$sex == "Male"], na.rm = TRUE) -
mean(data_processed_after_exclusions$iat_scores[data_processed_after_exclusions$sex == "Female"], na.rm = TRUE))
report(t_test_result)
set.seed(123)
reg_model_e <- lm(iat_D ~ bfi_e_mean, data = data_processed_after_exclusions)
reg_model_c <- lm(iat_D ~ bfi_e_mean, data = data_processed_after_exclusions)
reg_model_n <- lm(iat_D ~ bfi_e_mean, data = data_processed_after_exclusions)
reg_model_a <- lm(iat_D ~ bfi_e_mean, data = data_processed_after_exclusions)
reg_model_o <- lm(iat_D ~ bfi_e_mean, data = data_processed_after_exclusions)
report(reg_model_e)
report(reg_model_c)
report(reg_model_n)
report(reg_model_a)
report(reg_model_o)
reg_model_e_sum <- lm(iat_D ~ bfi_e_mean, data = data_processed_after_exclusions)|>summary()
reg_model_c_sum <- lm(iat_D ~ bfi_c_mean,data = data_processed_after_exclusions)|>summary()
reg_model_n_sum <- lm(iat_D ~ bfi_n_mean, data = data_processed_after_exclusions)|>summary()
reg_model_a_sum <- lm(iat_D ~ bfi_a_mean, data= data_processed_after_exclusions)|>summary()
reg_model_o_sum <- lm(iat_D ~ bfi_o_mean,data = data_processed_after_exclusions)|>summary()
# Extract the p-value for the iat_D coefficient
p_value_e <- reg_model_e_sum$coefficients["bfi_e_mean", "Pr(>|t|)"]
p_value_c <- reg_model_c_sum$coefficients["bfi_c_mean", "Pr(>|t|)"]
p_value_n <- reg_model_n_sum$coefficients["bfi_n_mean", "Pr(>|t|)"]
p_value_a <- reg_model_a_sum$coefficients["bfi_a_mean", "Pr(>|t|)"]
p_value_o <- reg_model_o_sum$coefficients["bfi_o_mean", "Pr(>|t|)"]
if (p_value_e < 0.05) {
cat("EXTROVERSION: The regression indicates that the relationship between bfi_e_mean and iat_D is statistically significant (p =", round(p_value_e,2), "). This suggests that extroversion has a significant impact on IAT scores.\n
Full results from the regression analysis for extraversion (bfi_e_mean) and IAT scores (iat_D) are presented in the following table.")
} else {
cat("EXTROVERSION: The regression does not provide evidence of a statistically significant relationship between extroversion and IAT scores (p =",round( p_value_e,2), ").\n
Full results from the regression analysis for extraversion (bfi_e_mean) and IAT scores (iat_D) are presented in the following table.")
}
reg_model_e
if (p_value_c < 0.05) {
cat("CONSCIENTIOUSNESS: The regression indicates that the relationship between bfi_e_mean and iat_D is statistically significant (p =", round( p_value_c,2), "). This suggests that conscientiousness has a significant impact on IAT scores.\n
Full results from the regression analysis for conscientiousness (bfi_c_mean) and IAT scores (iat_D) are presented in the following table.")
} else {
cat("CONSCIENTIOUSNESS: The regression does not provide evidence of a statistically significant relationship between conscientiousness and IAT scores (p =",round( p_value_c,2), ").\n
Full results from the regression analysis for conscientiousness (bfi_c_mean) and IAT scores (iat_D) are presented in the following table.")
}
{reg_model_c}
if (p_value_n < 0.05) {
cat("NEUROTICISM: The regression indicates that the relationship between bfi_e_mean and iat_D is statistically significant (p =", round( p_value_n,2), "). This suggests that neuroticism has a significant impact on IAT scores.\n
Full results from the regression analysis for neuroticism (bfi_n_mean) and IAT scores (iat_D) are presented in the following table.")
} else {
cat("NEUROTICISM: The regression does not provide evidence of a statistically significant relationship between neuroticism and IAT scores (p =", round( p_value_n,2), ").\n
Full results from the regression analysis for neuroticism (bfi_n_mean) and IAT scores (iat_D) are presented in the following table.")
}
{reg_model_n}
if (p_value_a < 0.05) {
cat("AGREEABLENESS: The regression indicates that the relationship between bfi_e_mean and iat_D is statistically significant (p =", round( p_value_a,2), "). This suggests that agreeableness has a significant impact on IAT scores.\n
Full results from the regression analysis for agreeableness (bfi_a_mean) and IAT scores (iat_D) are presented in the following table.")
} else {
cat("AGREEABLENESS: The regression does not provide evidence of a statistically significant relationship between agreeableness and IAT scores (p =", round( p_value_a,2), ").\n
Full results from the regression analysis for agreeableness (bfi_a_mean) and IAT scores (iat_D) are presented in the following table.")
}
{reg_model_a}
if (p_value_o < 0.05) {
cat("OPENNESS: The regression indicates that the relationship between bfi_e_mean and iat_D is statistically significant (p =", round( p_value_o,2), "). This suggests that openness has a significant impact on IAT scores.\n
Full results from the regression analysis for openness (bfi_o_mean) and IAT scores (iat_D) are presented in the following table.")
} else {
cat("OPENNESS: The regression does not provide evidence of a statistically significant relationship between openness and IAT scores (p =", round( p_value_o,2), ").\n
Full results from the regression analysis for openness (bfi_o_mean) and IAT scores (iat_D) are presented in the following table.")
}
{reg_model_o}
x_threshold_low <- quantile(data_processed_after_exclusions$iat_D, 0.1)
x_threshold_high <- quantile(data_processed_after_exclusions$iat_D, 0.9)
#extroversion
scatterplot_e<-ggplot(data_processed_after_exclusions, aes(x = bfi_e_mean, y = iat_D)) +
geom_point(aes(shape = ifelse(iat_D >= x_threshold_high | iat_D <= x_threshold_low, "triangle", "circle")),
size = 2,
color = "black") +
scale_shape_manual(values = c("triangle" = 17, "circle" = 16),
labels = c("triangle" = "Top/Bottom 10% of IAT Score", "circle" = "Middle 80% of IAT Score")) +
geom_smooth(method = "lm", color = viridis_pal(begin = 0.45, option = "mako")(1), size = 0.8) +
labs(title="Relationship between IAT and extroversion ",x="Mean extraversion",y="IAT Score",shape = "Legend") +
scale_y_continuous(breaks = c(-1,-.75, -0.5,-.25,0,0.25, 0.5))+
scale_x_continuous(breaks = c(2,2.5,3,3.5,4,4.5,5,5.5,6))+
theme_linedraw()
#conscientiousness
scatterplot_c<-ggplot(data_processed_after_exclusions, aes(x = bfi_c_mean, y = iat_D)) +
geom_point(aes(shape = ifelse(iat_D >= x_threshold_high | iat_D <= x_threshold_low, "triangle", "circle")),
size = 2,
color = "black") +
scale_shape_manual(values = c("triangle" = 17, "circle" = 16),
labels = c("triangle" = "Top/Bottom 10% of IAT Score", "circle" = "Middle 80% of IAT Score")) +
geom_smooth(method = "lm", color = viridis_pal(begin = 0.45, option = "mako")(1), size = 0.8) +
labs(title="Relationship between IAT and conscientiousness ",x="Mean conscientiousness",y="IAT Score",shape = "Legend") +
scale_y_continuous(breaks = c(-1,-.75, -0.5,-.25,0,0.25, 0.5))+
scale_x_continuous(breaks = c(2,2.5,3,3.5,4,4.5,5,5.5,6))+
theme_linedraw()
#neuroticism
scatterplot_n<-ggplot(data_processed_after_exclusions, aes(x = bfi_n_mean, y = iat_D)) +
geom_point(aes(shape = ifelse(iat_D >= x_threshold_high | iat_D <= x_threshold_low, "triangle", "circle")),
size = 2,
color = "black") +
scale_shape_manual(values = c("triangle" = 17, "circle" = 16),
labels = c("triangle" = "Top/Bottom 10% of IAT Score", "circle" = "Middle 80% of IAT Score")) +
geom_smooth(method = "lm", color = viridis_pal(begin = 0.45, option = "mako")(1), size = 0.8) +
labs(title="Relationship between IAT and neuroticism ",x="Mean neuroticism",y="IAT Score",shape = "Legend") +
scale_y_continuous(breaks = c(-1,-.75, -0.5,-.25,0,0.25, 0.5))+
scale_x_continuous(breaks = c(1.5,2,2.5,3,3.5,4,4.5,5,5.5,6))+
theme_linedraw()
#agreeableness
scatterplot_a<-ggplot(data_processed_after_exclusions, aes(x = bfi_a_mean, y = iat_D)) +
geom_point(aes(shape = ifelse(iat_D >= x_threshold_high | iat_D <= x_threshold_low, "triangle", "circle")),
size = 2,
color = "black") +
scale_shape_manual(values = c("triangle" = 17, "circle" = 16),
labels = c("triangle" = "Top/Bottom 10% of IAT Score", "circle" = "Middle 80% of IAT Score")) +
geom_smooth(method = "lm", color = viridis_pal(begin = 0.45, option = "mako")(1), size = 0.8) +
labs(title="Relationship between IAT and agreeableness ",x="Mean agreeableness",y="IAT Score",shape = "Legend") +
scale_y_continuous(breaks = c(-1,-.75, -0.5,-.25,0,0.25, 0.5))+
scale_x_continuous(breaks = c(2,2.5,3,3.5,4,4.5,5,5.5,6))+
theme_linedraw()
#openness
scatterplot_o<-ggplot(data_processed_after_exclusions, aes(x = bfi_o_mean, y = iat_D)) +
geom_point(aes(shape = ifelse(iat_D >= x_threshold_high | iat_D <= x_threshold_low, "triangle", "circle")),
size = 2,
color = "black") +
scale_shape_manual(values = c("triangle" = 17, "circle" = 16),
labels = c("triangle" = "Top/Bottom 10% of IAT Score", "circle" = "Middle 80% of IAT Score")) +
geom_smooth(method = "lm", color = viridis_pal(begin = 0.45, option = "mako")(1), size = 0.8) +
xlab("Mean openness") +
ylab("IAT Score") +
labs(title="Relationship between IAT and openness",x="Mean openness",y="IAT Score",shape = "Legend") +
scale_y_continuous(breaks = c(-1,-.75, -0.5,-.25,0,0.25, 0.5))+
scale_x_continuous(breaks = c(2,2.5,3,3.5,4,4.5,5,5.5,6))+
theme_linedraw()
scatterplot_e
scatterplot_c
scatterplot_n
scatterplot_a
scatterplot_o
x_threshold_low <- quantile(data_processed_after_exclusions$iat_D, 0.1)
x_threshold_high <- quantile(data_processed_after_exclusions$iat_D, 0.9)
#extraversion
scatterplot_e<-ggplot(data_processed_after_exclusions, aes(x = bfi_e_mean, y = iat_D)) +
geom_point(aes(shape = ifelse(iat_D > x_threshold_high | iat_D < x_threshold_low, "triangle", "circle")),
size = 1,
color = "black") +
scale_shape_manual(values = c("triangle" = 17, "circle" = 16),
labels = c("triangle" = "Top/Bottom 10% of IAT Score", "circle" = "Middle 80% of IAT Score")) +
geom_smooth(method = "lm", color = viridis_pal(begin = 0.45, option = "mako")(1), size = 0.7) +
xlab("Mean extraversion") +
ylab("IAT Score") +
theme_linedraw()+
theme(legend.position="none")
#conscientiousness
scatterplot_c<-ggplot(data_processed_after_exclusions, aes(x = bfi_c_mean, y = iat_D)) +
geom_point(aes(shape = ifelse(iat_D > x_threshold_high | iat_D < x_threshold_low, "triangle", "circle")),
size = 1,
color = "black") +
scale_shape_manual(values = c("triangle" = 17, "circle" = 16),
labels = c("triangle" = "Top/Bottom 10% of IAT Score", "circle" = "Middle 80% of IAT Score")) +
geom_smooth(method = "lm", color = viridis_pal(begin = 0.45, option = "mako")(1), size = 0.7) +
xlab("Mean conscientiousness") +
ylab("IAT Score") +
theme_linedraw()+
theme(legend.position="none")
#neuroticism
scatterplot_n<-ggplot(data_processed_after_exclusions, aes(x = bfi_n_mean, y = iat_D)) +
geom_point(aes(shape = ifelse(iat_D > x_threshold_high | iat_D < x_threshold_low, "triangle", "circle")),
size = 1,
color = "black") +
scale_shape_manual(values = c("triangle" = 17, "circle" = 16),
labels = c("triangle" = "Top/Bottom 10% of IAT Score", "circle" = "Middle 80% of IAT Score")) +
geom_smooth(method = "lm", color = viridis_pal(begin = 0.45, option = "mako")(1), size = 0.7) +
xlab("Mean neuroticism") +
ylab("IAT Score") +
theme_linedraw()+
theme(legend.position="none")
#agreeableness
scatterplot_a<-ggplot(data_processed_after_exclusions, aes(x = bfi_a_mean, y = iat_D)) +
geom_point(aes(shape = ifelse(iat_D > x_threshold_high | iat_D < x_threshold_low, "triangle", "circle")),
size = 1,
color = "black") +
scale_shape_manual(values = c("triangle" = 17, "circle" = 16),
labels = c("triangle" = "Top/Bottom 10% of IAT Score", "circle" = "Middle 80% of IAT Score")) +
geom_smooth(method = "lm", color = viridis_pal(begin = 0.45, option = "mako")(1), size = 0.7) +
xlab("Mean agreeableness") +
ylab("IAT Score") +
theme_linedraw()+
theme(legend.position="none")
#openness
scatterplot_o<-ggplot(data_processed_after_exclusions, aes(x = bfi_o_mean, y = iat_D)) +
geom_point(aes(shape = ifelse(iat_D > x_threshold_high | iat_D < x_threshold_low, "triangle", "circle")),
size = 1,
color = "black") +
scale_shape_manual(values = c("triangle" = 17, "circle" = 16),
labels = c("triangle" = "Top/Bottom 10% of IAT Score", "circle" = "Middle 80% of IAT Score")) +
geom_smooth(method = "lm", color = viridis_pal(begin = 0.45, option = "mako")(1), size = 0.7) +
xlab("Mean openness") +
ylab("IAT Score") +
theme_linedraw()+
theme(legend.position="none")
combineplot_horizontal <-
scatterplot_e + scatterplot_c +scatterplot_n + scatterplot_a + scatterplot_o +plot_annotation(
title = 'Relationship between IAT und big five subscales with regression line')
combineplot_horizontal
combineplot_vertical <-
( scatterplot_e + scatterplot_c + scatterplot_n + scatterplot_a + scatterplot_o +
ggplot() + geom_blank() +theme_void() +
theme(legend.position = "none"))+
plot_layout(heights = c(1, 1, 1)) + plot_annotation(
subtitle = "between IAT und big five subscales ")
ggsave("../communications/combineplot.png",dpi = 300,combineplot_vertical)
ggsave("../communications/combineplot.pdf",dpi = 300,combineplot_vertical)
sessionInfo()
